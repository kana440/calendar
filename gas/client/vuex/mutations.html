<script>
// mutations
const mutations = {
  updateRooms(state, payload){
    state.rooms = payload;
  },
  updateUserSettings(state, payload){
    state.user = payload
  },
  patchUserSettings(state, payload){
    //todo watch properties
    const update = {}
    for(let i in state.user){
      update[i] = state.user[i]
    }
    for(let i in payload){
      update[i] = payload[i]
    }
    state.user=update
  },
  updateNewUser(state, payload){
    state.newUser = payload
  },
  updateInitializing(state, payload){
    state.initializing = payload
  },
  updateCalendarEvents(state, payload) {
    const idx = state.calendarEvents.findIndex(query=>equalDate(query.date, payload.date))
    if(idx === -1 ) {
      state.calendarEvents.push(payload)
    } else {
      state.calendarEvents[idx] = payload
    }
  },
  updateFreeBusy(state, payload) {
    const idx = state.freeBusy.findIndex(query=>equalDate(query.date, payload.date))
    if(idx === -1 ) {
      state.freeBusy.push(payload)
    } else {
      state.freeBusy[idx] = payload
    }
  },
  updateroomsEvents(state, payload) {
    const idx = state.roomsEvents.findIndex(query=>{
      return equalDate(query.date, payload.date) && query.calendarId === payload.calendarId
    })
    if(idx === -1 ) {
      state.roomsEvents.push(payload)
    } else {
      state.roomsEvents[idx] = payload
    }
  },
  updateWatchList(state, payload){
    state.watchList = payload
  },
  clearCalendarEvents(state, payload) {
    state.calendarEvents=[]
  },
  clearRoomsEvents(state, payload) {
    state.roomsEvents = []
  },
  clearFreeBusy(state, payload) {
    state.roomsEvents = []
  },
  switchDrawer(state, payload) {
    state.drawer = !state.drawer
  },
  setDrawer(state, payload) {
    state.drawer = payload
  },
  updateSelectedDate(state, payload) {
    if(state.selectedDate !== payload) state.selectedEvent = null
    state.selectedDate = payload
  },
  updateSelectedEvent(state, payload){
    state.selectedEvent = payload
  },
  loadingOn(state, payload) {
    state.isLoading = true,
    state.loadingText = payload
  },
  pushHistory(state, payload) {
    state.history.push(payload)
  },
  loadingOff(state) {
    state.isLoading = false
    state.loadingText = ''
  },
  selectEvent(state, payload) {
    state.selectedEvent = payload.event
  },
  closeDialog(state) {
    state.isDialog = false
  },
}
</script>
